"use strict";(self["webpackChunkHawkeye"]=self["webpackChunkHawkeye"]||[]).push([[781],{781:function(e,t,r){r.r(t),r.d(t,{default:function(){return k}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"setting-card"},[t("el-dialog",{attrs:{title:"添加监控项",visible:e.dialogFormVisible,width:e.mobileClient?"80%":"50%"},on:{"update:visible":function(t){e.dialogFormVisible=t}},model:{value:e.dialogFormVisible,callback:function(t){e.dialogFormVisible=t},expression:"dialogFormVisible"}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"名称"}},[t("el-popover",{attrs:{placement:"right",title:"提示",width:"200",trigger:"hover"}},[e._v("若存在相同名称，会覆盖已有值 "),t("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})]),t("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.tag,callback:function(t){e.$set(e.form,"tag",t)},expression:"form.tag"}})],1),t("el-form-item",{attrs:{label:"关键字"}},[t("el-popover",{attrs:{placement:"right",title:"提示",width:"200",trigger:"hover"}},[e._v("熟悉 "),t("a",{attrs:{referrerpolicy:"no-referrer",href:"https://github.com/search/advanced",target:"_blank"}},[e._v("GitHub 搜索语法")]),e._v("可以提高监控效率: OR/AND/NOT "),t("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})]),t("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.keyword,callback:function(t){e.$set(e.form,"keyword",t)},expression:"form.keyword"}})],1),t("el-form-item",{attrs:{label:"开启/关闭"}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.form.enabled,callback:function(t){e.$set(e.form,"enabled",t)},expression:"form.enabled"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{round:"",size:"mini"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{round:"",size:"mini",type:"primary"},on:{click:function(t){return e.handleAddQuery(e.form)}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"批量添加监控项",visible:e.dialogFormVisibleBatch,width:e.mobileClient?"80%":"50%"},on:{"update:visible":function(t){e.dialogFormVisibleBatch=t}},model:{value:e.dialogFormVisibleBatch,callback:function(t){e.dialogFormVisibleBatch=t},expression:"dialogFormVisibleBatch"}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"关键字"}},[t("el-popover",{attrs:{placement:"right",title:"提示",width:"200",trigger:"hover"}},[e._v("熟悉 "),t("a",{attrs:{referrerpolicy:"no-referrer",href:"https://github.com/search/advanced",target:"_blank"}},[e._v("GitHub 搜索语法")]),e._v("可以提高监控效率: OR/AND/NOT "),t("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})]),t("el-input",{attrs:{type:"textarea",required:"required","auto-complete":"off",rows:4,placeholder:"多个关键字请使用换行分割"},model:{value:e.form.keyword,callback:function(t){e.$set(e.form,"keyword",t)},expression:"form.keyword"}})],1),t("el-form-item",{attrs:{label:"开启/关闭"}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.form.enabled,callback:function(t){e.$set(e.form,"enabled",t)},expression:"form.enabled"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{round:"",size:"mini"},on:{click:function(t){e.dialogFormVisibleBatch=!1}}},[e._v("取 消")]),t("el-button",{attrs:{round:"",size:"mini",type:"primary"},on:{click:function(t){return e.handleBatchAddQuery(e.form)}}},[e._v("确 定")])],1)],1),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v(" 添加 ")]),t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){e.dialogFormVisibleBatch=!0}}},[e._v(" 批量添加 ")]),t("el-table",{attrs:{data:e.rules,stripe:!0}},[t("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("router-link",{attrs:{to:"/?tag="+r.row.tag}},[e._v(" "+e._s(r.row.tag)+" ")])]}}])}),t("el-table-column",{attrs:{label:"关键字","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(r){return[t("a",{attrs:{rel:"noopener noreferrer",href:"https://github.com/search?o=desc&q="+r.row.keyword+"&ref=searchresults&s=indexed&type=Code&utf8=%E2%9C%93",target:"_blank"}},[e._v(e._s(r.row.keyword))])]}}])}),t("el-table-column",{attrs:{label:"最后抓取时间",prop:"last",width:"150",sortable:""},scopedSlots:e._u([{key:"default",fn:function(r){return[r.row.last?t("span",[e._v(e._s(e._f("timeAgo")(1e3*r.row.last)))]):e._e()]}}])}),t("el-table-column",{attrs:{label:"总数",width:"200",prop:"api_total",sortable:""}}),t("el-table-column",{attrs:{label:"已抓取",width:"200",prop:"found_total",sortable:""}}),t("el-table-column",{attrs:{label:"状态",width:"100",prop:"enabled",sortable:""},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.updateEnabled(r.row)}},model:{value:r.row.enabled,callback:function(t){e.$set(r.row,"enabled",t)},expression:"scope.row.enabled"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button-group",[t("el-button",{attrs:{size:"mini",plain:"",round:""},on:{click:function(t){return e.handleEdit(r.$index,r.row)}}},[e._v("编辑 ")]),t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.handleDeleteQuery(r.$index,r.row)}}},[e._v("删除 ")]),0===r.row.status?t("el-button",{attrs:{size:"mini",plain:"",round:"",type:"primary",icon:"el-icon-loading"},on:{click:function(t){return e.handleSpiderResult(r.row)}}}):e._e(),1===r.row.status?t("el-button",{attrs:{size:"mini",type:"success",plain:"",round:"",icon:"el-icon-success"},on:{click:function(t){return e.handleSpiderResult(r.row)}}}):e._e(),-1===r.row.status?t("el-button",{attrs:{size:"mini",type:"warning",plain:"",round:"",icon:"el-icon-warning"},on:{click:function(t){return e.handleSpiderResult(r.row)}}}):e._e()],1)]}}])})],1)],1)},i=[],a=["second","minute","hour","day","week","month","year"];function l(e,t){if(0===t)return["just now","right now"];var r=a[Math.floor(t/2)];return e>1&&(r+="s"),[e+" "+r+" ago","in "+e+" "+r]}var s=["秒","分钟","小时","天","周","个月","年"];function n(e,t){if(0===t)return["刚刚","片刻后"];var r=s[~~(t/2)];return[e+" "+r+"前",e+" "+r+"后"]}var c={},u=function(e,t){c[e]=t},d=function(e){return c[e]||c["en_US"]},m=[60,60,24,7,365/7/12,12];function f(e){return e instanceof Date?e:!isNaN(e)||/^\d+$/.test(e)?new Date(parseInt(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(e))}function h(e,t){var r=e<0?1:0;e=Math.abs(e);for(var o=e,i=0;e>=m[i]&&i<m.length;i++)e/=m[i];return e=Math.floor(e),i*=2,e>(0===i?9:1)&&(i+=1),t(e,i,o)[r].replace("%s",e.toString())}function b(e,t){var r=t?f(t):new Date;return(+r-+f(e))/1e3}var g=function(e,t,r){var o=b(e,r&&r.relativeDate);return h(o,d(t))};u("en_US",l),u("zh_CN",n);var p={data(){return{rules:{keyword:[{required:!0,message:"请输入名字"}]},dialogFormVisible:!1,dialogFormVisibleBatch:!1,form:{tag:"",keyword:"",enabled:!0}}},computed:{mobileClient(){return document.documentElement.clientWidth<document.documentElement.clientHeight}},methods:{handleEdit(e,t){this.form=t,this.dialogFormVisible=!0},fetchQuery:function(){this.axios.get(this.api.settingQuery).then((e=>{this.rules=e.data.result})).catch((e=>{this.$message.error(e.toString())}))},handleSpiderResult(e){const t=g(1e3*e.last,"zh_CN");e.status>-1?this.$message.success(t+e.reason):this.$message.warning(t+e.reason)},handleDeleteQuery(e,t){this.axios.delete(`${this.api.settingQuery}?_id=${t._id}&tag=${t.tag}`).then((e=>{this.$message.success(e.data.msg),this.dialogFormVisible=!1,this.rules=e.data.result})).catch((e=>{this.$message.error(e.toString()),this.dialogFormVisible=!1}))},updateEnabled(e){const t={tag:e.tag,keyword:e.keyword,enabled:e.enabled};this.axios.post(this.api.settingQuery,t).then((e=>{this.$message.success(e.data.msg),this.dialogFormVisible=!1,this.rules=e.data.result})).catch((e=>{this.$message.error(e.toString()),this.dialogFormVisible=!1}))},handleAddQuery(e){this.axios.post(this.api.settingQuery,e).then((e=>{this.$message.success(e.data.msg),this.dialogFormVisible=!1,this.rules=e.data.result,this.form={tag:"",keyword:"",enabled:!0}})).catch((e=>{this.$message.error(e.toString()),this.dialogFormVisible=!1}))},handleBatchAddQuery(e){this.axios.post(this.api.settingQuery,e).then((e=>{this.$message.success(e.data.msg),this.dialogFormVisibleBatch=!1,this.rules=e.data.result,this.form={keyword:"",enabled:!0}})).catch((e=>{this.$message.error(e.toString()),this.dialogFormVisibleBatch=!1}))}},mounted:function(){this.fetchQuery()}},w=p,v=r(1001),y=(0,v.Z)(w,o,i,!1,null,null,null),k=y.exports}}]);
//# sourceMappingURL=781.8520985b.js.map