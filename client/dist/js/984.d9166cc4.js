"use strict";(self["webpackChunkHunter"]=self["webpackChunkHunter"]||[]).push([[984],{7984:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var r=function(){var e=this,t=e._self._c;return t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{xs:24,sm:24,md:24,lg:12,xl:12}},[t("el-card",{staticClass:"card-panel",attrs:{shadow:"never"}},[t("div",{staticStyle:{"min-height":"250px"}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"GitHub用户"}},[t("img",{staticClass:"avatar",attrs:{src:e.leakageInfo.avatar_url,width:"32",height:"32",alt:"@"+e.leakageInfo.username}})]),t("el-form-item",{attrs:{label:"仓库地址"}},[t("a",{attrs:{href:e.leakageInfo.project_url,target:"_blank",referrerpolicy:"no-referrer"}},[e._v(e._s(e.leakageInfo.project))]),e._v(" – "),t("a",{attrs:{href:e.leakageInfo.link,target:"_blank",referrerpolicy:"no-referrer"}},[e._v(e._s(e.leakageInfo.filename))])]),t("el-form-item",{attrs:{label:"仓库信息"}},[t("div",{staticClass:"project-info"},[t("img",{attrs:{src:"https://img.shields.io/github/issues/"+e.leakageInfo.project+".svg?longCache=true&style=flat",alt:""}}),t("img",{attrs:{src:"https://img.shields.io/github/forks/"+e.leakageInfo.project+".svg?longCache=true&style=flat",alt:""}}),t("img",{attrs:{src:"https://img.shields.io/github/stars/"+e.leakageInfo.project+".svg?longCache=true&style=flat",alt:""}})])]),t("el-form-item",{attrs:{label:"编码语言"}},[e._v(" "+e._s(e.leakageInfo.language)+" ")]),t("el-form-item",{attrs:{label:"上传时间"}},[e._v(" "+e._s(e._f("dateFormat")(e.leakageInfo.datetime))+" ")]),t("el-form-item",{attrs:{label:"命中标签"}},[t("el-tag",{attrs:{size:"mini",type:"danger"}},[t("router-link",{attrs:{to:{name:"index",query:{tag:e.leakageInfo.tag}}}},[e._v(e._s(e.leakageInfo.tag)+" ")])],1)],1)],1)],1)])],1),t("el-col",{attrs:{xs:24,sm:24,md:24,lg:12,xl:12}},[t("el-card",{staticClass:"card-panel",attrs:{shadow:"never"}},[t("div",{staticStyle:{"min-height":"260px"}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"是否安全"}},[t("el-radio-group",{model:{value:e.form.security,callback:function(t){e.$set(e.form,"security",t)},expression:"form.security"}},[t("el-radio",{attrs:{label:1}},[e._v("安全")]),t("el-radio",{attrs:{label:0}},[e._v("涉密")])],1)],1),t("el-form-item",{attrs:{label:"忽略仓库"}},[t("el-radio-group",{model:{value:e.form.ignore,callback:function(t){e.$set(e.form,"ignore",t)},expression:"form.ignore"}},[t("el-radio",{attrs:{label:1}},[e._v("忽略")]),t("el-radio",{attrs:{label:0}},[e._v("监控")])],1)],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入...",rows:3},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:e.dealLeakage}},[e._v("确认")]),t("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){return e.quickCheck(e.leakageInfo)}}},[e._v("快速排查 ")])],1)],1)],1)])],1),e.code?t("el-col",{attrs:{span:24}},[t("div",{staticClass:"card"},[t("el-collapse",[t("el-collapse-item",{attrs:{title:"受影响资产 ("+e.affect.length+"个)",name:"affect"}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.affect,fit:""}},[t("el-table-column",{attrs:{prop:"type",label:"泄露类型"}}),t("el-table-column",{attrs:{prop:"value",label:"受影响资产"}})],1)],1)],1)],1),t("el-card",{attrs:{shadow:"never"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("i",{staticClass:"el-icon-document",staticStyle:{"margin-right":"4px"}}),t("a",{attrs:{href:e.leakageInfo.link,target:"_blank"}},[e._v("可疑文件")])]),t("highlight-code",{attrs:{lang:"python"}},[e._v(" "+e._s(e.code)+" ")])],1)],1):e._e()],1)},s=[],l=a(1436),i={data(){return{leakageInfo:{},code:"",affect:null,form:{security:1,ignore:1,desc:""}}},computed:{leakageID(){return this.$route.params.id}},methods:{quickCheck(e){const t=e.project_url+"/search?utf8=✓&q=pass OR password OR passwd OR pwd OR smtp OR database";window.open(t,"_blank")},fetchInfoData(){this.axios.get(this.api.leakageInfo,{params:{id:this.leakageID}}).then((e=>{this.leakageInfo=e.data.result,this.form.security=this.leakageInfo.security,this.form.project=this.leakageInfo.project,this.form.ignore=this.leakageInfo.ignore,this.form.desc=this.leakageInfo.desc})).catch((e=>{this.$message.error(e.toString())}))},fetchCodeData(){this.axios.get(this.api.leakageCode,{params:{id:this.leakageID}}).then((e=>{this.code=l.DS.decode(e.data.result.code),this.affect=e.data.result.affect})).catch((e=>{this.$message.error(e.toString())}))},dealLeakage(){this.form.id=this.$route.params.id,this.axios.patch(this.api.leakage,this.form).then((e=>{this.$message.success(e.data.msg)})).catch((e=>{this.$message.error(e.toString())}))}},mounted(){this.fetchInfoData(),this.fetchCodeData(),this.$nextTick((function(){}))}},o=i,n=a(1001),c=(0,n.Z)(o,r,s,!1,null,null,null),f=c.exports}}]);
//# sourceMappingURL=984.d9166cc4.js.map